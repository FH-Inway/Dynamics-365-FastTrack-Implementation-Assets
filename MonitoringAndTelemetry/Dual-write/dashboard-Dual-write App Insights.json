{"$schema":"https://dataexplorer.azure.com/static/d/schema/60/dashboard.json","id":"0337b0e2-cc42-4b81-9146-fd6e3bc20c93","eTag":"6499500b-4d0e-469a-a1aa-5d3800802d8d","title":"Dual-write App Insights","schema_version":"60","tiles":[{"id":"48663cd1-022f-471f-89c0-c517c470e212","title":"Dataverse dual-write errors - operations initiated in Dataverse which failed in F&O or Dataverse","visualType":"table","pageId":"0677f536-2034-4026-928a-37f766b2780f","layout":{"x":11,"y":6,"width":13,"height":9},"queryRef":{"kind":"query","queryId":"e457132c-327b-4337-9dd1-54d363649d82"},"description":"Errors for dualwrite operations initiated in Dataverse which failed in F&O","visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"1559619b-e0bb-488a-9a61-cb25ee915f03","title":"Daily generated error distribution - sum of operations initiated in F&O which failed in Dataverse and operations initiated in Dataverse which failed in F&O or Dataverse","visualType":"line","pageId":"0677f536-2034-4026-928a-37f766b2780f","layout":{"x":11,"y":0,"width":13,"height":6},"queryRef":{"kind":"query","queryId":"dbcf800f-8d81-409b-b549-c3839f443f36"},"description":"Includes operations initiated in F&O which failed in Dataverse and operations initiated in Dataverse which failed in F&O","visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"legendLocation":"bottom","xColumnTitle":"","xColumn":null,"yColumns":null,"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"d97f107d-d389-4cdd-91f0-65e2c3e52385","title":"Performance Account Dataverse SDK operations","visualType":"stackedcolumn","pageId":"0677f536-2034-4026-928a-37f766b2780f","layout":{"x":0,"y":7,"width":11,"height":7},"queryRef":{"kind":"query","queryId":"e1fe20c6-797e-4dd9-9adc-ed4f0a26a0d3"},"description":"Relevant for Dataverse initiated operations via UI or API","visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"legendLocation":"bottom","xColumnTitle":"","xColumn":null,"yColumns":null,"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"78de0aea-62b2-4aee-a231-6ebc13104753","title":"No of dual-write errors raised by SCM plugins in Dataverse","visualType":"card","pageId":"0677f536-2034-4026-928a-37f766b2780f","layout":{"x":0,"y":22,"width":5,"height":3},"queryRef":{"kind":"query","queryId":"6c46c197-2c36-4a18-a2b9-67bbc48a879f"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":null,"colorRulesDisabled":false,"colorStyle":"light","colorRules":[]}},{"id":"6795bdb4-0fd7-4240-a7ae-d3deae0e79a4","title":"F&O dual-write errors - operations initiated in F&O which failed in Dataverse","visualType":"table","pageId":"0677f536-2034-4026-928a-37f766b2780f","layout":{"x":11,"y":15,"width":13,"height":7},"queryRef":{"kind":"query","queryId":"3ab9064c-8254-40cd-aad1-106c7cc3935b"},"description":"Errors for dualwrite operations initiated in F&O which failed in Dataverse","visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"0fadfee6-a5ff-474f-90dc-42bad8932b15","title":"Errors raised by dual-write SCM plugins","visualType":"table","pageId":"0677f536-2034-4026-928a-37f766b2780f","layout":{"x":11,"y":22,"width":11,"height":7},"queryRef":{"kind":"query","queryId":"29d7706a-b1cd-4ff0-a995-0050574a5265"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"65a16bd8-7f59-454d-85c0-550e278ebc1c","title":"Monitor Account SDK Operations Success ","visualType":"line","pageId":"0677f536-2034-4026-928a-37f766b2780f","layout":{"x":0,"y":0,"width":11,"height":7},"queryRef":{"kind":"query","queryId":"055b7ca6-ab07-4047-b538-778b1147d93c"},"description":"Relevant for Dataverse initiated operations via UI or API","visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"legendLocation":"bottom","xColumnTitle":"","xColumn":"timestamp","yColumns":["TotalCount","SuccessCount"],"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"7f23eb1f-759e-4de5-a1d7-124ab61a55cf","title":"Performance Dataverse plugins for account events - last 24h","visualType":"table","pageId":"0677f536-2034-4026-928a-37f766b2780f","layout":{"x":0,"y":14,"width":11,"height":8},"queryRef":{"kind":"query","queryId":"4c55d951-e00e-4645-a3f0-2e523baec6b3"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}}],"baseQueries":[],"parameters":[{"kind":"duration","id":"68c2d26d-8e7d-4d49-9106-b6e605c46316","displayName":"Time range","description":"","beginVariableName":"_startTime","endVariableName":"_endTime","defaultValue":{"kind":"dynamic","count":1,"unit":"hours"},"showOnPages":{"kind":"all"}}],"dataSources":[{"id":"7670944f-ad85-49ee-af2a-97509855028d","kind":"manual-kusto","scopeId":"kusto","name":"https%3A%2F%2Fade.applicationinsights.io%2Fsubscriptions%<Subscription-ID>","clusterUri":"https://ade.applicationinsights.io/subscriptions/<Subscription-ID>","database":"sandbox1sfappinsights"}],"pages":[{"name":"Page 1","id":"0677f536-2034-4026-928a-37f766b2780f"}],"queries":[{"dataSource":{"kind":"inline","dataSourceId":"7670944f-ad85-49ee-af2a-97509855028d"},"text":"exceptions\n| where timestamp > _startTime and timestamp <= _endTime\n| extend cd = parse_json(tostring(customDimensions))\n| where customDimensions contains \"Microsoft.Dynamics.Integrator\" or cd.entityName in ('account','contact','quote','msdyn_party', 'msdyn_postaladdress')\n| order by timestamp desc ","id":"e457132c-327b-4337-9dd1-54d363649d82","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"7670944f-ad85-49ee-af2a-97509855028d"},"text":"exceptions\n| where timestamp >= _startTime and timestamp <= _endTime\n| extend cd = parse_json(tostring(customDimensions))\n| where customDimensions has 'DualWriteChangeProcessor' or customDimensions contains \"Microsoft.Dynamics.Integrator\" or cd.entityName in ('account','contact','quote','msdyn_party', 'msdyn_postaladdress')\n| extend Day = startofday(timestamp)  // Extract only the date part\n| summarize ErrorCount = count() by Day\n| order by Day asc\n| render linechart \n","id":"dbcf800f-8d81-409b-b549-c3839f443f36","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"7670944f-ad85-49ee-af2a-97509855028d"},"text":"// monitor Dataverse initiated account SDK CUD, in case of error use id to query exception operation_ParentId\n\n// track Create, Update, Delete operations for account Dataverse initiated CUD operations\ndependencies\n| where timestamp >= _startTime and timestamp <= _endTime\n| where type in~ (\"SDKCreate\", \"SDKUpdate\", \"SDKDelete\", \"SDKUpsert\", \"SDKUpsertMultiple\",\"SDKRetrieve\")\n| where name in~ (\"account\")\n| where isempty(operation_SyntheticSource) \n| where user_Id != \"00000000-0000-0000-0000-000000000000\"\n| extend Day = startofday(timestamp)  // Extract only the date part\n| summarize TotalCount = count() by bin(timestamp, 1d), performanceBucket\n| render columnchart \n\n","id":"e1fe20c6-797e-4dd9-9adc-ed4f0a26a0d3","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"7670944f-ad85-49ee-af2a-97509855028d"},"text":"// Please enter your KQL query (Example):\n// <table name>\n// | where <datetime column> between (['_startTime'] .. ['_endTime']) // Time range filtering\n// | take 100\nexceptions\n| where timestamp >= _startTime and timestamp <= _endTime\n| where customDimensions has \"Microsoft.Dynamics.SCMExtended\"\n| summarize count()","id":"6c46c197-2c36-4a18-a2b9-67bbc48a879f","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"7670944f-ad85-49ee-af2a-97509855028d"},"text":"exceptions\n| where timestamp > _startTime and timestamp <= _endTime\n| where customDimensions has 'DualWriteChangeProcessor'\n| order by timestamp desc \n| project timestamp, outerMessage, details, itemType, customDimensions, session_Id, user_Id","id":"3ab9064c-8254-40cd-aad1-106c7cc3935b","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"7670944f-ad85-49ee-af2a-97509855028d"},"text":"// Errors raised by Dual-write SCM plugins\nexceptions\n| where timestamp >= _startTime and timestamp <= _endTime\n| where customDimensions has \"Microsoft.Dynamics.SCMExtended\"\n| project timestamp, outerMessage, type, customDimensions, operation_Id, operation_ParentId, user_Id, session_Id","id":"29d7706a-b1cd-4ff0-a995-0050574a5265","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"7670944f-ad85-49ee-af2a-97509855028d"},"text":"// track Create, Update, Delete operations for account Dataverse initiated CUD operations\ndependencies\n| where timestamp >= _startTime and timestamp <= _endTime\n| where type in~ (\"SDKCreate\", \"SDKUpdate\", \"SDKDelete\", \"SDKUpsert\", \"SDKUpsertMultiple\",\"SDKRetrieve\")\n| where name in~ (\"account\")\n| where isempty(operation_SyntheticSource) \n| where user_Id != \"00000000-0000-0000-0000-000000000000\"\n| extend Day = startofday(timestamp)  // Extract only the date part\n| summarize SuccessCount = countif(success == true), TotalCount = count() by bin(timestamp, 1d)\n| extend SuccessRate = todouble(SuccessCount) / todouble(TotalCount) * 100\n| render timechart\n","id":"055b7ca6-ab07-4047-b538-778b1147d93c","usedVariables":["_endTime","_startTime"]},{"dataSource":{"kind":"inline","dataSourceId":"7670944f-ad85-49ee-af2a-97509855028d"},"text":"// Performance of Dataverse plugins triggered by table account events from the last 24h\ndependencies\n| where timestamp between (ago(1d) .. now())\n| where type == \"Plugin\"\n| extend cd = parse_json(tostring(customDimensions))\n| where cd.entityName == \"account\"\n| extend Day = startofday(timestamp)  // Extract only the date part\n| summarize TotalExecution = count(), PerceivedErrors = countif(success==\"False\"), AverageDuration = toint(avg(duration)),maxExecutionTime = max(duration),\n            Slow3s = countif(duration >=3000),Slow5s = countif(duration >=5000),        \n            Slow8s = countif(duration >=8000),Slow15s = countif(duration >=15000),Slow30s = countif(duration >=30000)\n  by tostring(cd.pluginName)\n","id":"4c55d951-e00e-4645-a3f0-2e523baec6b3","usedVariables":[]}]}